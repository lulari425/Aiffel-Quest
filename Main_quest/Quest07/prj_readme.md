 # 프로젝트 회고

## 1. 프로젝트 개요

이번 프로젝트에서는 의료 영상 데이터셋을 이용해 U-Net 기반의 세그멘테이션 모델을 학습시켰습니다.   
또한, 모델 성능을 향상시키기 위해 Pretrained 모델을 Encoder로 사용하여 U-Net 모델을 개선했습니다.   
주요 목표는 U-Net과 Pretrained U-Net 모델을 비교 분석하여,  
Pretrained 모델을 활용한 U-Net이 일반 U-Net보다 더 나은 성능을 발휘하는지 평가하는 것이었습니다.  

## 2. 진행한 작업 및 방법  

### 데이터셋 준비  
- **Giana Dataset**을 사용하여 위 내시경 이미지 데이터를 준비하고, 이미지와 마스크를 각각 학습(train)과 테스트(test) 데이터로 분리했습니다.  
- 데이터 증강(Data Augmentation)을 통해 학습 데이터셋의 다양성을 높이고, 모델의 일반화 성능을 향상시키고자 했습니다.
- 주요 augmentation 기법으로는 이미지 회전, 이동, 수평 반전을 사용했습니다.  

### U-Net 모델 구성 및 학습  
- 기본 **U-Net 모델**을 구축하고 학습을 진행했습니다. 이 모델은 의료 영상 세그멘테이션을 위한 Encoder-Decoder 구조로 설계되었습니다.  
- 모델 학습 후에는 손실 함수와 학습률을 설정하여 학습을 최적화했습니다.  

### Pretrained U-Net 모델 구성 및 학습  
- **Pretrained 모델(VGG16)**을 Encoder로 사용하여 U-Net 모델을 개선했습니다.  
- VGG16의 특정 레이어 출력을 활용하여 U-Net의 Decoder와 연결함으로써, 모델의 초기 학습 성능을 향상시키고자 했습니다.   
- 개선된 U-Net 모델을 학습시키고, 동일한 설정 하에 성능을 평가했습니다.  

## 3. 프로젝트에서의 어려움과 해결 방법  

### 데이터 전처리와 Augmentation  
- 데이터 증강 과정에서, 라벨 이미지와 실제 이미지를 동일하게 변환해야 했습니다.
- 이를 위해 `tf.data.Dataset`과 `map` 함수를 사용하여 이미지와 라벨에 동일한 증강 변환을 적용했습니다.  

### 모델 학습 과정에서의 에러  
- 학습 과정에서 모델 손실 함수를 잘못 참조하여 `'list' object is not callable` 에러가 발생했습니다.
  이를 해결하기 위해 커널을 재시작하고, 손실 함수와 관련된 모든 참조를 명확하게 수정했습니다.  
- 모델 구성 및 컴파일 과정에서도 여러 오류가 있었지만, TensorFlow의 에러 메시지를 기반으로 문제를 파악하고 적절히 수정했습니다.  

### Encoder-Decoder 모델 학습 및 모델 성능 비교분석 누락  

## 4. 결과 분석 및 성과

### U-Net 모델 성능  (mean_iou: 0.9381448561518053)  
- 기본 U-Net 모델은 의료 영상 세그멘테이션 태스크에서 준수한 성능을 보였습니다.
  데이터 증강 기법을 통해 모델의 일반화 성능을 높일 수 있었습니다. 

### Pretrained U-Net 모델 성능 (Mean IoU: 0.9450264339249993)  
- VGG16을 Encoder로 사용한 Pretrained U-Net 모델은 기본 U-Net 모델에 비해 더 빠르게 수렴하고 더 나은 초기 성능을 보였습니다.  
- 이는 ImageNet 데이터로 사전 학습된 가중치가 초기화 과정에서 도움이 되었기 때문입니다.    

## 5. 프로젝트의 의의와 향후 개선점  

### 의의  
- 이번 프로젝트는 U-Net 모델과 Pretrained U-Net 모델의 성능 차이를 비교하며,  
  Pretrained 모델을 사용함으로써 얻을 수 있는 성능 향상 효과를 확인하는 데 중점을 두었습니다.   
 이를 통해 의료 영상 처리에서 Transfer Learning이 유효할 수 있음을 경험할 수 있었습니다.     

### 향후 개선점   
- 데이터셋의 크기가 제한적이었기 때문에, 더 큰 데이터셋을 사용하거나 다양한 유형의 의료 영상 데이터를 추가로 확보하여 모델을 더욱 일반화할 수 있을 것입니다.  
- 추가적인 Pretrained 모델(예: ResNet, DenseNet 등)을 사용하여 Encoder를 구성하고, 각 모델의 성능을 비교 분석하는 것도 유의미할 것입니다.  
- **Hyperparameter Tuning**을 통해 최적의 학습률, 배치 크기, 네트워크 깊이 등을 탐색하여 모델 성능을 더욱 향상시킬 수 있을 것입니다.

## 6. 결론  

이번 프로젝트를 통해 기본 U-Net 모델과 Pretrained U-Net 모델을 구축하고 비교하면서 Transfer Learning의 이점을 확인할 수 있었습니다.   
또한, 의료 영상 데이터를 다룰 때 고려해야 할 다양한 요소들(예: 데이터 증강, 모델 구성 등)에 대해 실질적인 경험을 쌓을 수 있었습니다.     
향후 더 다양한 접근과 실험을 통해 모델 성능을 지속적으로 개선할 수 있을 것으로 기대됩니다.     
